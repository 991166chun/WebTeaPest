<!doctype html>
{% load static %}
<html lang="en">

<h3 class="h4 text-step  mb-2 mt-2">請問本影像的拍攝地點與海拔?</h3>
    <!-- <p class="text-muted mb-0">
        region and altitude</p> -->

    <form class="form-inline  text-left mt-3" id="RegionForm"
         data-cities-url="{% url 'ajax_load_cities' %}"
         action="{% url 'add_region' %}" method="post">
        {% csrf_token %}
        <div class="form-group text-left">
            <label class="mx-1" for="county">縣市別:</label>
            <select class="form-control mx-1" name="county" id="county">
                <option value="">---------</option>
                {% for county in counties %}
                <option value="{{ county.name }}">{{ county.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group text-left">
            <label class="mx-1" for="city">鄉鎮市區:</label>
            <select class="form-control mx-1" name="city" id="city">
                <option value="">---------</option>
                
            </select>
        </div>
        <div class="form-group">
            <label class="mx-1" for="altitude">海拔高度:</label>
            <select class="form-control mx-1 ml-2" name="altitude">
                <option>---m ~ ---m</option>
                <option>0m ~ 500m</option>
                <option>500m ~ 1000m</option>
                <option>1500m ~ 2000m</option>
                <option>2000m ~ </option>
            </select>
        </div>
        <input name="imgid" type="hidden" value="{{ imgs.img_id }}" readonly>
        <button type="submit" class="btn btn-info ml-3 mt-3">送出</button>
    </form>
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        $("select#county").change(function () {
            var url = $("#RegionForm").attr("data-cities-url");  // get the url of the `load_cities` view
            var countyId = $(this).val();  // get the selected county ID from the HTML input
            console.log(url+'?county='+countyId);
            $.ajax({      // initialize an AJAX request
            type: "GET",                 
            url: url,     // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
            data: {
                'county': countyId       // add the county id to the GET parameters
            },
            dataType: 'json',
            success: function (result) {
                    $("#city option").remove();
                    $("#city").append('<option>---------</option>');
                    for (var i = result.length - 1; i >= 0; i--) {
                        $("#city").append('<option>'+ result[i].name +'</option>');
                    };
                }
            })
        
        });
    </script>
